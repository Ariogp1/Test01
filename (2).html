<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ø§Ø¨Ø²Ø§Ø± ØªØ¨Ø¯ÛŒÙ„ Ù…Ù‚ÛŒØ§Ø³</title>
  <style>
    :root { --bg:#0f1320; --card:#161a2b; --muted:#8ea0b9; --text:#eef3ff; --accent:#7aa2ff; }
    *{box-sizing:border-box}
    body{margin:0;background:radial-gradient(1200px 800px at 20% -10%, #1b2140 0%, var(--bg) 60%), var(--bg);font-family:ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial; color:var(--text);}
    .wrap{max-width:860px;margin:40px auto;padding:24px}
    h1{font-size:22px;margin:0 0 16px}
    p.desc{margin:0 0 22px;color:var(--muted)}
    .card{background:linear-gradient(180deg, #1a1f36, #121629);border:1px solid #2a2f47; padding:18px;border-radius:16px; box-shadow:0 10px 30px rgba(0,0,0,.35)}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:14px}
    .row-3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:14px}
    label{display:block;font-size:12px;color:#aab8d8;margin:0 0 6px}
    select,input{width:100%;padding:12px 12px;border-radius:12px;border:1px solid #2b3152;background:#0f1326;color:var(--text);outline:none}
    input[type="number"]::-webkit-outer-spin-button,input[type="number"]::-webkit-inner-spin-button{ -webkit-appearance:none; margin:0;}
    .grid{display:grid;gap:16px}
    .hint{font-size:12px;color:#94a3c7}
    .out{background:linear-gradient(180deg, #0f1428, #0b1022);padding:16px;border-radius:14px;border:1px dashed #2f365e}
    .mono{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}
    .big{font-size:28px; font-weight:700}
    .copy{cursor:pointer;border:1px solid #2b3152;background:#0f1326;color:#cdd7ff;border-radius:10px;padding:8px 10px}
    .flex{display:flex; align-items:center; gap:12px; flex-wrap:wrap}
    .hstack{display:flex; align-items:center; gap:8px}
    .toggle-inline{display:inline-flex; align-items:center; gap:0; white-space:nowrap}
    .toggle-inline .hint{margin:0; line-height:1; padding:0; transform: translateX(-4px);}
    .toggle-inline input[type="checkbox"]{margin:0; padding:0; width:16px; height:16px; vertical-align:middle;}
    .footer{margin-top:16px; color:#90a4d4; font-size:12px}
    .ok{color:#99ffcc}
    .warn{color:#ffd479}
    .ig-link{display:inline-flex;align-items:center;gap:6px;margin-inline-start:8px;color:#cdd7ff;text-decoration:none;border:1px solid #2b3152;padding:4px 8px;border-radius:8px}
    .ig-link:hover{border-color:#7aa2ff}
    .ig{width:14px;height:14px}
    .handle{display:inline-flex; flex-direction:row; align-items:center; gap:0; direction:ltr; white-space:nowrap; line-height:1}
    .handle .at{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; display:inline}
    .swap{position:relative}
    .swap > *{width:100%}
    .swap.manual #scaleSelect{display:none}
    .swap.manual #scaleN{display:block}
    .swap:not(.manual) #scaleSelect{display:block}
    .swap:not(.manual) #scaleN{display:none}
    /* --- Light/Dark theme switch --- */
    .topbar{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px}
    .switch{position:relative;cursor:pointer;border:1px solid #2b3152;background:#0f1326;color:var(--text);border-radius:999px;display:inline-flex;align-items:center;justify-content:center;width:54px;height:28px;padding:0}
    .switch span{pointer-events:none}
    .switch .thumb{position:absolute;top:2px;left:2px;width:24px;height:24px;border-radius:999px;background:var(--accent);box-shadow:0 2px 6px rgba(0,0,0,.35);transition:transform .25s ease}
    .switch .icon{position:absolute;top:50%;transform:translateY(-50%);font-size:12px;opacity:.9}
    .switch .icon.sun{left:8px}
    .switch .icon.moon{right:8px}
    .switch[data-mode="light"] .thumb{transform:translateX(26px)}

    /* Light overrides */
    body.light{background:linear-gradient(180deg,#ffffff,#f6f8ff);color:#0d1220}
    body.light .card{background:#ffffff;border-color:#e2e8f0;box-shadow:0 10px 30px rgba(0,0,0,.06)}
    body.light label{color:#56617a}
    body.light select, body.light input{background:#ffffff;border-color:#cbd5e1;color:#0d1220}
    body.light .out{background:#f4f6fb;border-color:#d0d8e6}
    body.light .copy{background:#ffffff;border-color:#cbd5e1;color:#0d1220}
    body.light .hint{color:#64748b}
    body.light .footer{color:#5f6b88}
    body.light .ig-link{color:#334155;border-color:#cbd5e1}
    body.light .ig-link:hover{border-color:#3b82f6}
    body.light .switch{background:#ffffff;border-color:#cbd5e1;color:#0d1220}

    
      /* Force zero gap when both classes present */
    .hstack.toggle-inline{gap:0 !important;}
  .ltr{direction:ltr;text-align:left}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="topbar">
      <h1>Ø§Ø¨Ø²Ø§Ø± ØªØ¨Ø¯ÛŒÙ„ Ù…Ù‚ÛŒØ§Ø³</h1>
      <button id="themeToggle" class="switch" aria-label="ØªØºÛŒÛŒØ± Ø­Ø§Ù„Øª Ø±ÙˆØ´Ù†/ØªØ§Ø±ÛŒÚ©" data-mode="dark">
        <span class="icon sun" aria-hidden="true">â˜€ï¸</span>
        <span class="icon moon" aria-hidden="true">ğŸŒ™</span>
        <span class="thumb" aria-hidden="true"></span>
      </button>
    </div>
    <p class="desc">ÙˆØ§Ø­Ø¯ Ø¯Ù†ÛŒØ§ÛŒ ÙˆØ§Ù‚Ø¹ÛŒ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯ (Ù‡Ù…ÛŒØ´Ù‡ <strong>Û±:Û±</strong>)ØŒ Ø³Ù¾Ø³ Ù…Ù‚ÛŒØ§Ø³ Ù‡Ø¯Ù <strong>Û±:N</strong> Ùˆ ÙˆØ§Ø­Ø¯ Ù†Ù‚Ø´Ù‡ Ø±Ø§ Ø¨Ø±Ú¯Ø²ÛŒÙ†ÛŒØ¯. Ù…Ù‚Ø¯Ø§Ø± ÙˆØ§Ù‚Ø¹ÛŒ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯ ØªØ§ Ø§Ù†Ø¯Ø§Ø²Ù‡ Ø±ÙˆÛŒ Ù†Ù‚Ø´Ù‡ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø´ÙˆØ¯.</p>

    <div class="card grid" role="form" aria-label="ÙØ±Ù… Ù…Ø¨Ø¯Ù‘Ù„ Ù…Ù‚ÛŒØ§Ø³">
      <div class="row-3">
        <div>
          <label for="realUnit">ÙˆØ§Ø­Ø¯ ÙˆØ§Ù‚Ø¹ÛŒ (Û±:Û±)</label>
          <select id="realUnit" aria-label="ÙˆØ§Ø­Ø¯ ÙˆØ§Ù‚Ø¹ÛŒ">
            <option value="mm">Ù…ÛŒÙ„ÛŒâ€ŒÙ…ØªØ± (mm)</option>
            <option value="cm">Ø³Ø§Ù†ØªÛŒâ€ŒÙ…ØªØ± (cm)</option>
            <option value="m" selected>Ù…ØªØ± (m)</option>
            <option value="km">Ú©ÛŒÙ„ÙˆÙ…ØªØ± (km)</option>
            <option value="in">Ø§ÛŒÙ†Ú† (in)</option>
            <option value="ft">ÙÙˆØª (ft)</option>
            <option value="yd">ÛŒØ§Ø±Ø¯ (yd)</option>
            <option value="mi">Ù…Ø§ÛŒÙ„ (mi)</option>
            <option value="nmi">Ù…Ø§ÛŒÙ„ Ø¯Ø±ÛŒØ§ÛŒÛŒ (nmi)</option>
          </select>
        </div>
        <div>
          <label for="scaleSelect">Ù…Ù‚ÛŒØ§Ø³ Ù‡Ø¯Ù â€” Û±:N</label>
          <div class="grid" style="gap:8px">
            <div id="scaleSwap" class="swap">
              <select id="scaleSelect" aria-label="Ø§Ù†ØªØ®Ø§Ø¨ Ù…Ù‚ÛŒØ§Ø³">
                <optgroup label="Ø¬Ø²Ø¦ÛŒØ§Øª (Detail)">
                  <option value="1">Û±:Û±</option>
                  <option value="2">Û±:Û²</option>
                  <option value="5">Û±:Ûµ</option>
                  <option value="10">Û±:Û±Û°</option>
                </optgroup>
                <optgroup label="Ù†Ù‚Ø´Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ø¹Ù…Ø§Ø±ÛŒ (Plans)">
                  <option value="20">Û±:Û²Û°</option>
                  <option value="25">Û±:Û²Ûµ</option>
                  <option value="50">Û±:ÛµÛ°</option>
                  <option value="75">Û±:Û·Ûµ</option>
                  <option value="100">Û±:Û±Û°Û°</option>
                  <option value="125">Û±:Û±Û²Ûµ</option>
                  <option value="150">Û±:Û±ÛµÛ°</option>
                  <option value="200" selected>Û±:Û²Û°Û°</option>
                  <option value="250">Û±:Û²ÛµÛ°</option>
                </optgroup>
                <optgroup label="Ø³Ø§ÛŒØª/Ø´Ù‡Ø± (Site/Urban)">
                  <option value="400">Û±:Û´Û°Û°</option>
                  <option value="500">Û±:ÛµÛ°Û°</option>
                  <option value="1000">Û±:Û±Û°Û°Û°</option>
                  <option value="2000">Û±:Û²Û°Û°Û°</option>
                  <option value="5000">Û±:ÛµÛ°Û°Û°</option>
                </optgroup>
              </select>
              <input id="scaleN" type="number" min="1" step="1" value="200" aria-label="Ø¹Ø¯Ø¯ N Ù…Ù‚ÛŒØ§Ø³" class="ltr" />
            </div>
            <label class="hstack toggle-inline">
              <input type="checkbox" id="manualToggle" />
              <span class="hint">ÙˆØ±ÙˆØ¯ Ù…Ù‚Ø¯Ø§Ø± Ø¯Ù„Ø®ÙˆØ§Ù‡ Ù…Ù‚ÛŒØ§Ø³ Ù‡Ø¯Ù</span>
            </label>
          </div>
        </div>
        <div>
          <label for="targetUnit">ÙˆØ§Ø­Ø¯ Ù†Ù‚Ø´Ù‡</label>
          <select id="targetUnit" aria-label="ÙˆØ§Ø­Ø¯ Ù†Ù‚Ø´Ù‡">
            <option value="mm">Ù…ÛŒÙ„ÛŒâ€ŒÙ…ØªØ± (mm)</option>
            <option value="cm" selected>Ø³Ø§Ù†ØªÛŒâ€ŒÙ…ØªØ± (cm)</option>
            <option value="m">Ù…ØªØ± (m)</option>
            <option value="km">Ú©ÛŒÙ„ÙˆÙ…ØªØ± (km)</option>
            <option value="in">Ø§ÛŒÙ†Ú† (in)</option>
            <option value="ft">ÙÙˆØª (ft)</option>
            <option value="yd">ÛŒØ§Ø±Ø¯ (yd)</option>
            <option value="mi">Ù…Ø§ÛŒÙ„ (mi)</option>
            <option value="nmi">Ù…Ø§ÛŒÙ„ Ø¯Ø±ÛŒØ§ÛŒÛŒ (nmi)</option>
          </select>
        </div>
      </div>

      <div class="row">
        <div>
          <label for="realValue">Ø§Ù†Ø¯Ø§Ø²Ù‡ ÙˆØ§Ù‚Ø¹ÛŒ (ÙÙ‚Ø· Ø¹Ø¯Ø¯)</label>
          <input id="realValue" type="text" inputmode="decimal" placeholder="Ù…Ø«Ù„Ø§Ù‹ Û±Û²Ù«Ûµ ÛŒØ§ 12.5" aria-label="Ø§Ù†Ø¯Ø§Ø²Ù‡ ÙˆØ§Ù‚Ø¹ÛŒ" class="ltr" dir="ltr" />
          <div class="hint" id="realHint">ÙˆØ§Ø­Ø¯: m</div>
        </div>
        <div>
          <label>Ø§Ù†Ø¯Ø§Ø²Ù‡Ù” Ø±ÙˆÛŒ Ù†Ù‚Ø´Ù‡ (Ù…Ø­Ø§Ø³Ø¨Ù‡â€ŒØ´Ø¯Ù‡)</label>
          <div class="out">
            <div class="big mono" id="outVal">â€”</div>
            <div class="hint" id="outUnit">ÙˆØ§Ø­Ø¯: cm</div>
            <div class="flex" style="margin-top:8px">
              <button type="button" class="copy" id="copyBtn" title="Ú©Ù¾ÛŒ Ù…Ù‚Ø¯Ø§Ø±">Ú©Ù¾ÛŒ</button>
              <span class="hint" id="copyNote"></span>
            </div>
          </div>
        </div>
      </div>

      <div class="grid">
        <div class="hint">Ø¬Ø²Ø¦ÛŒØ§Øª Ù…Ø¨Ø¯Ù„: <span class="mono" id="detail">Û± (ÙˆØ§Ø­Ø¯ ÙˆØ§Ù‚Ø¹ÛŒ) â†’ ØŸ (ÙˆØ§Ø­Ø¯ Ù†Ù‚Ø´Ù‡) Ø¯Ø± Ù…Ù‚ÛŒØ§Ø³ Û±:N</span></div>
        <div class="footer">Ø³Ø§Ø®ØªÙ‡ Ø´Ø¯Ù‡ ØªÙˆØ³Ø· <strong>Pixel Studio</strong>
          <a class="ig-link" href="https://instagram.com/Pixel_architecture_studio" target="_blank" rel="noopener" aria-label="Instagram: @Pixel_architecture_studio">
            <svg class="ig" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <rect x="2" y="2" width="20" height="20" rx="5" ry="5" stroke="currentColor" stroke-width="1.5"></rect>
              <circle cx="12" cy="12" r="4" stroke="currentColor" stroke-width="1.5"></circle>
              <circle cx="17.5" cy="6.5" r="1.2" fill="currentColor"></circle>
            </svg>
            <span class="handle"><span class="at" aria-hidden="true">@</span><span class="mono ltr">pixel_architecture_studio</span></span>
          </a>
        </div>

        </div>
    </div>

    <div class="footer" style="margin-top:10px">Ù†Ú©ØªÙ‡: Ø¨Ø±Ø§ÛŒ Ù…Ù‚ÛŒØ§Ø³â€ŒØ¯Ø§Ø¯Ù† Ø¨Ù‡ Ù‡Ù†Ø¯Ø³Ù‡ Ø¯Ø± CAD Ø§Ø² <span class="mono ltr">scale factor = 1 / N</span> Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯ (Ù…Ø«Ù„Ø§Ù‹ Ø¨Ø±Ø§ÛŒ <span class="mono ltr">1:200</span>ØŒ Ø¶Ø±ÛŒØ¨ <span class="mono ltr">0.005</span> Ø§Ø³Øª). Ø§ÛŒÙ† Ø§Ø¨Ø²Ø§Ø± ØªØ¨Ø¯ÛŒÙ„ ÙˆØ§Ø­Ø¯Ù‡Ø§ Ø±Ø§ Ø¨Ø§ Ù‡Ù…ÛŒÙ† Ù…Ù‚ÛŒØ§Ø³ Ø§Ù†Ø¬Ø§Ù… Ù…ÛŒâ€ŒØ¯Ù‡Ø¯.</div>
  </div>

  <script>
    const unitToMM = {
      mm: 1,
      cm: 10,
      m: 1000,
      km: 1000000,
      in: 25.4,
      ft: 304.8,
      yd: 914.4,
      mi: 1609344,
      nmi: 1852000
    };
    const el = (id) => document.getElementById(id);

    const realUnit = el('realUnit');
    const targetUnit = el('targetUnit');
    const scaleSelect = el('scaleSelect');
    const manualToggle = el('manualToggle');
    const scaleSwap = el('scaleSwap');
    const scaleN = el('scaleN');
    const realValue = el('realValue');
    const outVal = el('outVal');
    const outUnit = el('outUnit');
    const realHint = el('realHint');
    const detail = el('detail');
    const copyBtn = el('copyBtn');
    const copyNote = el('copyNote');
    const themeToggle = el('themeToggle');

    function fmt(n){
      if (Number.isNaN(n)) return 'â€”';
      // Show up to 6 decimals, trim trailing zeros
      const s = n.toFixed(6).replace(/\.0+$/,'').replace(/(\.[0-9]*?)0+$/, '$1');
      return s;
    }

    function updateHints(){
      realHint.textContent = `ÙˆØ§Ø­Ø¯: ${realUnit.value}`;
      outUnit.textContent = `ÙˆØ§Ø­Ø¯: ${targetUnit.value}`;
    }

    function applyTheme(theme){
      if (theme === 'light') document.body.classList.add('light');
      else document.body.classList.remove('light');
      if (themeToggle){
        const isLight = document.body.classList.contains('light');
        themeToggle.setAttribute('data-mode', isLight ? 'light' : 'dark');
      }
    }

    function initTheme(){
      let theme = localStorage.getItem('theme');
      if (!theme){
        try { theme = (window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches) ? 'light' : 'dark'; }
        catch(e){ theme = 'dark'; }
      }
      applyTheme(theme);
    }

    function setManualUI(){
      const manual = manualToggle && manualToggle.checked;
      scaleN.disabled = !manual;
      scaleSelect.disabled = manual;
      if (scaleSwap) scaleSwap.classList.toggle('manual', manual);
    }

    function calcDrawing(rv, rU, N, tU){
      const realMM = rv * unitToMM[rU];
      const drawingMM = realMM / N;
      return drawingMM / unitToMM[tU];
    }

    function normalizeNumber(str){
      if (!str) return '';
      var s = String(str);
      var fa = 'Û°Û±Û²Û³Û´ÛµÛ¶Û·Û¸Û¹';
      var ar = 'Ù Ù¡Ù¢Ù£Ù¤Ù¥Ù¦Ù§Ù¨Ù©';
      s = s.replace(/[Û°-Û¹]/g, function(d){ return String(fa.indexOf(d)); })
           .replace(/[Ù -Ù©]/g, function(d){ return String(ar.indexOf(d)); });
      s = s.replace(/[Ù¬, ]/g, '');
      s = s.replace(/[Ù«ØŒ]/g, '.');
      s = s.replace(/[^0-9.+-]/g, '');
      return s;
    }

    function compute(){
      const rv = parseFloat(normalizeNumber(realValue.value));
      const manual = manualToggle && manualToggle.checked;
      const N = manual ? parseFloat(scaleN.value) : parseFloat(scaleSelect.value);
      const rU = realUnit.value;
      const tU = targetUnit.value;

      updateHints();

      if (!rv || rv < 0 || !N || N <= 0){
        outVal.textContent = 'â€”';
        const nLabel = (N && N > 0) ? fmt(N) : (manual ? 'N' : (scaleSelect.value || 'N'));
        detail.textContent = `Û± ${rU} â†’ ØŸ ${tU} Ø¯Ø± Ù…Ù‚ÛŒØ§Ø³ Û±:${nLabel}`;
        return;
      }

      const drawingVal = calcDrawing(rv, rU, N, tU);
      outVal.textContent = `${fmt(drawingVal)} ${tU}`;

      // Also show how many target units equal 1 real unit at this scale
      const oneRealToTarget = (unitToMM[rU] / N) / unitToMM[tU];
      detail.textContent = `Û± ${rU} = ${fmt(oneRealToTarget)} ${tU}  (Ù…Ù‚ÛŒØ§Ø³ Û±:${fmt(N)})`;
    }

    realUnit.addEventListener('change', compute);
    targetUnit.addEventListener('change', compute);
    scaleSelect.addEventListener('change', compute);
    manualToggle.addEventListener('change', () => { setManualUI(); compute(); });
    scaleN.addEventListener('input', compute);
    realValue.addEventListener('input', compute);
    if (themeToggle) themeToggle.addEventListener('click', function(){
      const isLight = !document.body.classList.contains('light');
      applyTheme(isLight ? 'light' : 'dark');
      localStorage.setItem('theme', isLight ? 'light' : 'dark');
    });

    copyBtn.addEventListener('click', async () => {
      const raw = outVal.textContent || '';
      let val = raw.trim();
      if (!val || val === 'â€”') {
        copyNote.textContent = 'Ø§Ø¨ØªØ¯Ø§ Ù…Ù‚Ø¯Ø§Ø± Ø±Ø§ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ú©Ù†ÛŒØ¯';
        setTimeout(function(){ copyNote.textContent = ''; }, 1500);
        return;
      }
      // remove unit suffix if present
      const units = ['mm','cm','m','km','in','ft','yd','mi','nmi'];
      for (var i=0;i<units.length;i++){
        var u = units[i];
        if (val.endsWith(' ' + u)) { val = val.slice(0, -(u.length+1)); break; }
      }
      var ok = false;
      if (navigator.clipboard && window.isSecureContext) {
        try { await navigator.clipboard.writeText(val); ok = true; } catch(e) { ok = false; }
      }
      if (!ok) {
        try {
          var ta = document.createElement('textarea');
          ta.value = val;
          ta.style.position = 'fixed';
          ta.style.left = '-1000px';
          ta.style.top = '-1000px';
          ta.style.opacity = '0';
          document.body.appendChild(ta);
          ta.focus();
          ta.select();
          try { ta.setSelectionRange(0, ta.value.length); } catch(e){}
          ok = document.execCommand('copy');
          document.body.removeChild(ta);
        } catch(e) { ok = false; }
      }
      copyNote.textContent = ok ? 'Ú©Ù¾ÛŒ Ø´Ø¯!' : 'Ú©Ù¾ÛŒ Ù†Ø§Ù…ÙˆÙÙ‚';
      setTimeout(function(){ copyNote.textContent = ''; }, 1500);
    });

    

    // Initialize
    initTheme();
    updateHints();
    setManualUI();
    compute();
  </script>
</body>
</html>
